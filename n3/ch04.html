<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>N3 ë‹¨ì–´ì¥ Ch.4</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #1a1a2e; color: #eee; min-height: 100vh; }
        .container { max-width: 500px; margin: 0 auto; padding: 12px; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 8px; }
        h1 { font-size: 1.3rem; margin: 0; color: #fff; }
        .progress { font-size: 0.9rem; color: #888; }
        .controls { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 12px; justify-content: center; }
        .toggle-btn { padding: 8px 14px; border: none; border-radius: 20px; font-size: 0.85rem; cursor: pointer; transition: all 0.2s; }
        .toggle-btn.active { background: #4a5568; color: #fff; }
        .toggle-btn.inactive { background: #2d3748; color: #718096; }
        .toggle-btn.shuffle { background: #805ad5; color: #fff; }
        .toggle-btn.reset { background: #dd6b20; color: #fff; }
        .category-select { width: 100%; padding: 10px; border: none; border-radius: 10px; background: #2d3748; color: #fff; font-size: 0.95rem; margin-bottom: 12px; }
        .card { background: linear-gradient(145deg, #16213e, #1a1a2e); border-radius: 16px; padding: 28px 20px; min-height: 280px; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 8px 32px rgba(0,0,0,0.3); margin-bottom: 16px; border: 1px solid #2d3748; }
        .kanji { font-family: 'Noto Sans JP', sans-serif; font-size: 3rem; font-weight: bold; color: #fff; margin-bottom: 16px; text-align: center; line-height: 1.3; }
        .reading { font-family: 'Noto Sans JP', sans-serif; font-size: 1.4rem; color: #63b3ed; margin-bottom: 20px; text-align: center; }
        .meaning { font-size: 1.5rem; color: #68d391; text-align: center; padding: 12px 20px; background: rgba(104, 211, 145, 0.1); border-radius: 10px; }
        .hidden { visibility: hidden; }
        .nav-buttons { display: flex; gap: 12px; justify-content: center; }
        .nav-btn { flex: 1; max-width: 150px; padding: 14px 20px; border: none; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .nav-btn.prev { background: #4a5568; color: #fff; }
        .nav-btn.next { background: #4299e1; color: #fff; }
        .nav-btn:active { transform: scale(0.96); }
        .category-tag { font-size: 0.75rem; padding: 4px 10px; background: #4a5568; border-radius: 12px; margin-bottom: 16px; color: #a0aec0; }
        .tap-hint { text-align: center; font-size: 0.8rem; color: #555; margin-top: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../index.html#modal-n3" style="padding:6px 12px;background:#38a169;color:#fff;text-decoration:none;border-radius:8px;font-size:0.85rem;">â† í™ˆ</a>
            <h1>N3 ë‹¨ì–´ì¥ Ch.4</h1>
            <span class="progress" id="progress">1 / 100</span>
        </header>
        <select class="category-select" id="categorySelect" onchange="changeCategory()">
            <option value="all">ì „ì²´</option>
            <option value="ìŒë…ëª…ì‚¬">ìŒë… ëª…ì‚¬</option>
            <option value="í›ˆë…ëª…ì‚¬">í›ˆë… ëª…ì‚¬</option>
            <option value="ë™ì‚¬">ë™ì‚¬</option>
            <option value="ã„í˜•ìš©ì‚¬">ã„í˜•ìš©ì‚¬</option>
            <option value="ãªí˜•ìš©ì‚¬">ãªí˜•ìš©ì‚¬</option>
            <option value="ë¶€ì‚¬">ë¶€ì‚¬ ë° ê¸°íƒ€</option>
            <option value="ê°€íƒ€ì¹´ë‚˜">ê°€íƒ€ì¹´ë‚˜ì–´</option>
        </select>
        <div class="card" id="card">
            <span class="category-tag" id="categoryTag">ëª…ì‚¬</span>
            <div class="kanji" id="kanji">æ¼¢å­—</div>
            <div class="reading" id="reading">ã‹ã‚“ã˜</div>
            <div class="meaning" id="meaning">í•œì</div>
        </div>
        <div class="controls">
            <button class="toggle-btn reset" onclick="resetOrder()">â†º ì´ˆê¸°í™”</button>
            <button class="toggle-btn shuffle" onclick="shuffleCards()">ğŸ”€ ì…”í”Œ</button>
            <button class="toggle-btn active" id="toggleReading" onclick="toggleReading()">ë°œìŒ í‘œì‹œ</button>
            <button class="toggle-btn active" id="toggleMeaning" onclick="toggleMeaning()">ì •ë‹µ í‘œì‹œ</button>
        </div>
        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="prevCard()">â—€ ì´ì „</button>
            <button class="nav-btn next" onclick="nextCard()">ë‹¤ìŒ â–¶</button>
        </div>
        <p class="tap-hint">ì¹´ë“œë¥¼ ê¸¸ê²Œ ëˆ„ë¥´ë©´ ì •ë‹µ í‘œì‹œ</p>
    </div>
    <script>
        const STORAGE_KEY = 'n3_ch04_state';
        const words = [
            // ìŒë… ëª…ì‚¬
            {kanji: "å…¬åœ’", reading: "ã“ã†ãˆã‚“", meaning: "ê³µì›", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "éƒŠå¤–", reading: "ã“ã†ãŒã„", meaning: "êµì™¸, ë³€ë‘ë¦¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å…¬å®³", reading: "ã“ã†ãŒã„", meaning: "ê³µí•´", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è¬›ç¾©", reading: "ã“ã†ã", meaning: "ê°•ì˜", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å·¥æ¥­", reading: "ã“ã†ãã‚‡ã†", meaning: "ê³µì—…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "é«˜æ ¡", reading: "ã“ã†ã“ã†", meaning: "ê³ êµ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "åºƒå‘Š", reading: "ã“ã†ã“ã", meaning: "ê´‘ê³ ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "äº¤å·®ç‚¹", reading: "ã“ã†ã•ã¦ã‚“", meaning: "êµì°¨ì , êµì°¨ë¡œ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å·¥äº‹", reading: "ã“ã†ã˜", meaning: "ê³µì‚¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å·¥å ´", reading: "ã“ã†ã˜ã‚‡ã†", meaning: "ê³µì¥", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ç´…èŒ¶", reading: "ã“ã†ã¡ã‚ƒ", meaning: "í™ì°¨", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ ¡é•·", reading: "ã“ã†ã¡ã‚‡ã†", meaning: "êµì¥", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "äº¤é€š", reading: "ã“ã†ã¤ã†", meaning: "êµí†µ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è¡Œå‹•", reading: "ã“ã†ã©ã†", meaning: "í–‰ë™", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "äº¤ç•ª", reading: "ã“ã†ã°ã‚“", meaning: "íŒŒì¶œì†Œ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å‘¼å¸", reading: "ã“ãã‚…ã†", meaning: "í˜¸í¡", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å›½éš›", reading: "ã“ãã•ã„", meaning: "êµ­ì œ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "åˆå¾Œ", reading: "ã”ã”", meaning: "ì˜¤í›„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ•…éšœ", reading: "ã“ã—ã‚‡ã†", meaning: "ê³ ì¥", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å€‹äºº", reading: "ã“ã˜ã‚“", meaning: "ê°œì¸", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "åˆå‰", reading: "ã”ãœã‚“", meaning: "ì˜¤ì „", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ã”ã¡ãã†", reading: "ã”ã¡ãã†", meaning: "ë§›ìˆëŠ” ìŒì‹", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å¾¡é£¯", reading: "ã”ã¯ã‚“", meaning: "ë°¥", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä»Šæœˆ", reading: "ã“ã‚“ã’ã¤", meaning: "ì´ë²ˆ ë‹¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ··é›‘", reading: "ã“ã‚“ã–ã¤", meaning: "í˜¼ì¡", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä»Šé€±", reading: "ã“ã‚“ã—ã‚…ã†", meaning: "ê¸ˆì£¼, ì´ë²ˆ ì£¼", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä»Šåº¦", reading: "ã“ã‚“ã©", meaning: "ì´ë²ˆ, ë‹¤ìŒ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä»Šæ™©", reading: "ã“ã‚“ã°ã‚“", meaning: "ì˜¤ëŠ˜ ë°¤, ì˜¤ëŠ˜ ì €ë…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä»Šå¤œ", reading: "ã“ã‚“ã‚„", meaning: "ì˜¤ëŠ˜ ë°¤", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "éš›", reading: "ã•ã„", meaning: "ë•Œ, ì‹œê¸°, ì¦ˆìŒ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æœ€è¿‘", reading: "ã•ã„ãã‚“", meaning: "ìµœê·¼", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æœ€å¾Œ", reading: "ã•ã„ã”", meaning: "ìµœí›„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æœ€é«˜", reading: "ã•ã„ã“ã†", meaning: "ìµœê³ ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æœ€åˆ", reading: "ã•ã„ã—ã‚‡", meaning: "ìµœì´ˆ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æœ€æ–°", reading: "ã•ã„ã—ã‚“", meaning: "ìµœì‹ ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è²¡å¸ƒ", reading: "ã•ã„ãµ", meaning: "ì§€ê°‘", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä½œæ¥­", reading: "ã•ãã‚‡ã†", meaning: "ì‘ì—…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä½œæ–‡", reading: "ã•ãã¶ã‚“", meaning: "ì‘ë¬¸", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ˜¨å¹´", reading: "ã•ãã­ã‚“", meaning: "ì‘ë…„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ˜¨å¤œ", reading: "ã•ãã‚„", meaning: "ì–´ì ¯ë°¤", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "é›‘èªŒ", reading: "ã–ã£ã—", meaning: "ì¡ì§€", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ç ‚ç³–", reading: "ã•ã¨ã†", meaning: "ì„¤íƒ•", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å·®åˆ¥", reading: "ã•ã¹ã¤", meaning: "ì°¨ë³„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å†æ¥å¹´", reading: "ã•ã‚‰ã„ã­ã‚“", meaning: "ë‚´í›„ë…„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å‚åŠ ", reading: "ã•ã‚“ã‹", meaning: "ì°¸ê°€", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ç”£æ¥­", reading: "ã•ã‚“ãã‚‡ã†", meaning: "ì‚°ì—…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ®‹æ¥­", reading: "ã–ã‚“ãã‚‡ã†", meaning: "ì”ì—…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å‚è€ƒ", reading: "ã•ã‚“ã“ã†", meaning: "ì°¸ê³ ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ•£æ­©", reading: "ã•ã‚“ã½", meaning: "ì‚°ë³´, ì‚°ì±…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å¸‚", reading: "ã—", meaning: "ì‹œ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å­—", reading: "ã˜", meaning: "ê¸€ì", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å¸ä¼š", reading: "ã—ã‹ã„", meaning: "ì‚¬íšŒ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ™‚é–“", reading: "ã˜ã‹ã‚“", meaning: "ì‹œê°„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è‡³æ€¥", reading: "ã—ãã‚…ã†", meaning: "ì§€ê¸‰, ë§¤ìš° ê¸‰í•¨", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è©¦é¨“", reading: "ã—ã‘ã‚“", meaning: "ì‹œí—˜", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "äº‹ä»¶", reading: "ã˜ã‘ã‚“", meaning: "ì‚¬ê±´", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è³‡æº", reading: "ã—ã’ã‚“", meaning: "ìì›", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "äº‹æ•…", reading: "ã˜ã“", meaning: "ì‚¬ê³ ", category: "ìŒë…ëª…ì‚¬"},
            
            // í›ˆë… ëª…ì‚¬
            {kanji: "å£°", reading: "ã“ãˆ", meaning: "ëª©ì†Œë¦¬", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ä»Šå¹´", reading: "ã“ã¨ã—", meaning: "ì˜¬í•´", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "è¨€è‘‰", reading: "ã“ã¨ã°", meaning: "ë§", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å°é³¥", reading: "ã“ã¨ã‚Š", meaning: "ì‘ì€ ìƒˆ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ã“ã®é ƒ", reading: "ã“ã®ã”ã‚", meaning: "ìš”ì¦˜", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ç±³", reading: "ã“ã‚", meaning: "ìŒ€", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ã€œé ƒ", reading: "ã€œã”ã‚", meaning: "~ë¬´ë µ, ~ì¦ˆìŒ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å‚", reading: "ã•ã‹", meaning: "ì–¸ë•", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é­š", reading: "ã•ã‹ãª", meaning: "ë¬¼ê³ ê¸°, ìƒì„ ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å…ˆ", reading: "ã•ã", meaning: "ë, ì•", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "è©¦åˆ", reading: "ã—ã‚ã„", meaning: "ì‹œí•©", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å¡©", reading: "ã—ãŠ", meaning: "ì†Œê¸ˆ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ä»•äº‹", reading: "ã—ã”ã¨", meaning: "ì¼", category: "í›ˆë…ëª…ì‚¬"},
            
            // ë™ì‚¬
            {kanji: "è€ƒãˆã‚‹", reading: "ã‹ã‚“ãŒãˆã‚‹", meaning: "ìƒê°í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ„Ÿã˜ã‚‹", reading: "ã‹ã‚“ã˜ã‚‹", meaning: "ëŠë¼ë‹¤", category: "ë™ì‚¬"},
            {kanji: "é ‘å¼µã‚‹", reading: "ãŒã‚“ã°ã‚‹", meaning: "ë…¸ë ¥í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ¶ˆãˆã‚‹", reading: "ããˆã‚‹", meaning: "êº¼ì§€ë‹¤, ì‚¬ë¼ì§€ë‹¤", category: "ë™ì‚¬"},
            {kanji: "èã", reading: "ãã", meaning: "ë“£ë‹¤, ë¬»ë‹¤", category: "ë™ì‚¬"},
            {kanji: "èã“ãˆã‚‹", reading: "ãã“ãˆã‚‹", meaning: "ë“¤ë¦¬ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ±ºã¾ã‚‹", reading: "ãã¾ã‚‹", meaning: "ì •í•´ì§€ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ±ºã‚ã‚‹", reading: "ãã‚ã‚‹", meaning: "ì •í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "åˆ‡ã‚‹", reading: "ãã‚‹", meaning: "ìë¥´ë‹¤, ëŠë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç€ã‚‹", reading: "ãã‚‹", meaning: "ì…ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ããŸã³ã‚Œã‚‹", reading: "ããŸã³ã‚Œã‚‹", meaning: "ì§€ì¹˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "é…ã‚‹", reading: "ãã°ã‚‹", meaning: "ë‚˜ëˆ„ì–´ì£¼ë‹¤", category: "ë™ì‚¬"},
            {kanji: "çµ„ã‚€", reading: "ãã‚€", meaning: "ë¼ë‹¤, ì§œë‹¤", category: "ë™ì‚¬"},
            {kanji: "ãã‚‚ã‚‹", reading: "ãã‚‚ã‚‹", meaning: "íë¦¬ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æš®ã‚‰ã™", reading: "ãã‚‰ã™", meaning: "ì‚´ë‹¤, ìƒí™œí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ¯”ã¹ã‚‹", reading: "ãã‚‰ã¹ã‚‹", meaning: "ë¹„êµí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æš®ã‚Œã‚‹", reading: "ãã‚Œã‚‹", meaning: "(í•´Â·ê³„ì ˆ ë“±ì´) ì €ë¬¼ë‹¤", category: "ë™ì‚¬"},
            {kanji: "åŠ ãˆã‚‹", reading: "ãã‚ãˆã‚‹", meaning: "ë”í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ¶ˆã™", reading: "ã‘ã™", meaning: "ë„ë‹¤, ì§€ìš°ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç­”ãˆã‚‹", reading: "ã“ãŸãˆã‚‹", meaning: "ì‘ë‹µí•˜ë‹¤, ëŒ€ë‹µí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ–­ã‚‹", reading: "ã“ã¨ã‚ã‚‹", meaning: "ê±°ì ˆí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å›°ã‚‹", reading: "ã“ã¾ã‚‹", meaning: "ë‚œì²˜í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è¾¼ã‚€", reading: "ã“ã‚€", meaning: "ë¶ë¹„ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è»¢ã¶", reading: "ã“ã‚ã¶", meaning: "êµ¬ë¥´ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å£Šã™", reading: "ã“ã‚ã™", meaning: "ë¶€ìˆ˜ë‹¤, íŒŒê´´í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å£Šã‚Œã‚‹", reading: "ã“ã‚ã‚Œã‚‹", meaning: "ë¶€ì„œì§€ë‹¤, íŒŒê´´ë˜ë‹¤, ê³ ì¥ë‚˜ë‹¤", category: "ë™ì‚¬"},
            
            // ã„í˜•ìš©ì‚¬
            {kanji: "è¾›ã„", reading: "ã‹ã‚‰ã„", meaning: "ë§µë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "è»½ã„", reading: "ã‹ã‚‹ã„", meaning: "ê°€ë³ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "å¯æ„›ã‚‰ã—ã„", reading: "ã‹ã‚ã„ã‚‰ã—ã„", meaning: "ê·€ì—½ë‹¤, ì‚¬ë‘ìŠ¤ëŸ½ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "æ±šã„", reading: "ããŸãªã„", meaning: "ë”ëŸ½ë‹¤, ì§€ì €ë¶„í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ãã¤ã„", reading: "ãã¤ã„", meaning: "í˜ë“¤ë‹¤, ê½‰ ë¼ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "å³ã—ã„", reading: "ãã³ã—ã„", meaning: "ì—„ê²©í•˜ë‹¤, í˜¹ë…í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ãã ã‚‰ãªã„", reading: "ãã ã‚‰ãªã„", meaning: "ì‹œì‹œí•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ãã‚„ã—ã„", reading: "ãã‚„ã—ã„", meaning: "ë¶„í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "æš—ã„", reading: "ãã‚‰ã„", meaning: "ì–´ë‘¡ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "è‹¦ã—ã„", reading: "ãã‚‹ã—ã„", meaning: "ê´´ë¡­ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "é»’ã„", reading: "ãã‚ã„", meaning: "ê²€ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "è©³ã—ã„", reading: "ãã‚ã—ã„", meaning: "ìì„¸í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            
            // ãªí˜•ìš©ì‚¬
            {kanji: "å¹¸ã„ã ", reading: "ã•ã„ã‚ã„ã ", meaning: "ë‹¤í–‰ì´ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "ç››ã‚“ã ", reading: "ã•ã‹ã‚“ã ", meaning: "ë²ˆì„±í•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "æ§˜ã€…ã ", reading: "ã•ã¾ã–ã¾ã ", meaning: "ë‹¤ì–‘í•˜ë‹¤, ì—¬ëŸ¬ ê°€ì§€ì´ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "çˆ½ã‚„ã‹ã ", reading: "ã•ã‚ã‚„ã‹ã ", meaning: "ìƒì¾Œí•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "æ®‹å¿µã ", reading: "ã–ã‚“ã­ã‚“ã ", meaning: "ìœ ê°ì´ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "å¹¸ã›ã ", reading: "ã—ã‚ã‚ã›ã ", meaning: "í–‰ë³µí•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "é™ã‹ã ", reading: "ã—ãšã‹ã ", meaning: "ì¡°ìš©í•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "å¤±ç¤¼ã ", reading: "ã—ã¤ã‚Œã„ã ", meaning: "ë¬´ë¡€í•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            
            // ë¶€ì‚¬ ë° ê¸°íƒ€
            {kanji: "ã•ã™ãŒ", reading: "ã•ã™ãŒ", meaning: "ëª¹ì‹œ", category: "ë¶€ì‚¬"},
            {kanji: "ã—ã£ã‹ã‚Š", reading: "ã—ã£ã‹ã‚Š", meaning: "ê½‰, ì•„ë¬´ì§€ê²Œ, ì œëŒ€ë¡œ", category: "ë¶€ì‚¬"},
            {kanji: "å¾ã€…ã«", reading: "ã˜ã‚‡ã˜ã‚‡ã«", meaning: "ì„œì„œíˆ", category: "ë¶€ì‚¬"},
            {kanji: "ãšã„ã¶ã‚“", reading: "ãšã„ã¶ã‚“", meaning: "ëª¹ì‹œ, ëŒ€ë‹¨íˆ", category: "ë¶€ì‚¬"},
            {kanji: "å°‘ãªãã¨ã‚‚", reading: "ã™ããªãã¨ã‚‚", meaning: "ì ì–´ë„", category: "ë¶€ì‚¬"},
            {kanji: "å°‘ã—", reading: "ã™ã“ã—", meaning: "ì¡°ê¸ˆ, ì•½ê°„", category: "ë¶€ì‚¬"},
            {kanji: "ã™ã£ã‹ã‚Š", reading: "ã™ã£ã‹ã‚Š", meaning: "ì™„ì „íˆ", category: "ë¶€ì‚¬"},
            {kanji: "ã›ã£ã‹ã", reading: "ã›ã£ã‹ã", meaning: "ëª¨ì²˜ëŸ¼", category: "ë¶€ì‚¬"},
            {kanji: "çµ¶å¯¾", reading: "ãœã£ãŸã„", meaning: "ì ˆëŒ€", category: "ë¶€ì‚¬"},
            {kanji: "ãã£ã¨", reading: "ãã£ã¨", meaning: "ì‚´ì§, ëª°ë˜", category: "ë¶€ì‚¬"},
            {kanji: "ãã‚ãã‚", reading: "ãã‚ãã‚", meaning: "ìŠ¬ìŠ¬", category: "ë¶€ì‚¬"},
            
            // ê°€íƒ€ì¹´ë‚˜ì–´
            {kanji: "ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«", reading: "ã‚³ãƒ³ã‚¯ãƒ¼ãƒ«", meaning: "ì½©ì¿ ë¥´", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆ", reading: "ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆ", meaning: "ì½˜í¬ë¦¬íŠ¸", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚³ãƒ³ã‚»ãƒ³ãƒˆ", reading: "ã‚³ãƒ³ã‚»ãƒ³ãƒˆ", meaning: "ì½˜ì„¼íŠ¸", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼", reading: "ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼", meaning: "ì»´í“¨í„°", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚µãƒ¼ãƒ“ã‚¹", reading: "ã‚µãƒ¼ãƒ“ã‚¹", meaning: "ì„œë¹„ìŠ¤", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚µãƒ©ãƒ€", reading: "ã‚µãƒ©ãƒ€", meaning: "ìƒëŸ¬ë“œ", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚·ãƒªãƒ¼ã‚º", reading: "ã‚·ãƒªãƒ¼ã‚º", meaning: "ì‹œë¦¬ì¦ˆ", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚·ãƒ£ãƒ¯ãƒ¼", reading: "ã‚·ãƒ£ãƒ¯ãƒ¼", meaning: "ìƒ¤ì›Œ", category: "ê°€íƒ€ì¹´ë‚˜"},
        ];

        let currentIndex = 0;
        let filteredWords = [...words];
        let showReading = true;
        let showMeaning = true;
        let currentCategory = 'all';
        let isNavigating = false;
        let longPressTimer = null;
        let isLongPress = false;

        function saveState() {
            const state = { currentIndex, showReading, showMeaning, currentCategory };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const state = JSON.parse(saved);
                currentIndex = state.currentIndex || 0;
                showReading = state.showReading !== undefined ? state.showReading : true;
                showMeaning = state.showMeaning !== undefined ? state.showMeaning : true;
                currentCategory = state.currentCategory || 'all';
                document.getElementById('categorySelect').value = currentCategory;
                if (currentCategory !== 'all') {
                    filteredWords = words.filter(w => w.category === currentCategory);
                }
                if (currentIndex >= filteredWords.length) currentIndex = 0;
                updateToggleButtons();
            }
        }

        function updateToggleButtons() {
            const readingBtn = document.getElementById('toggleReading');
            const meaningBtn = document.getElementById('toggleMeaning');
            readingBtn.className = showReading ? 'toggle-btn active' : 'toggle-btn inactive';
            readingBtn.textContent = showReading ? 'ë°œìŒ í‘œì‹œ' : 'ë°œìŒ ìˆ¨ê¹€';
            meaningBtn.className = showMeaning ? 'toggle-btn active' : 'toggle-btn inactive';
            meaningBtn.textContent = showMeaning ? 'ì •ë‹µ í‘œì‹œ' : 'ì •ë‹µ ìˆ¨ê¹€';
        }

        function updateCard() {
            const word = filteredWords[currentIndex];
            document.getElementById('kanji').textContent = word.kanji;
            document.getElementById('reading').textContent = word.reading;
            document.getElementById('meaning').textContent = word.meaning;
            document.getElementById('categoryTag').textContent = word.category;
            document.getElementById('progress').textContent = `${currentIndex + 1} / ${filteredWords.length}`;
            applyVisibility();
            saveState();
        }

        function applyVisibility() {
            document.getElementById('reading').className = showReading ? 'reading' : 'reading hidden';
            document.getElementById('meaning').className = showMeaning ? 'meaning' : 'meaning hidden';
        }

        function toggleReading() {
            showReading = !showReading;
            updateToggleButtons();
            applyVisibility();
            saveState();
        }

        function toggleMeaning() {
            showMeaning = !showMeaning;
            updateToggleButtons();
            applyVisibility();
            saveState();
        }

        function revealTemporary() {
            document.getElementById('reading').className = 'reading';
            document.getElementById('meaning').className = 'meaning';
        }

        function hideTemporary() {
            applyVisibility();
        }

        function nextCard() {
            if (isNavigating) return;
            isNavigating = true;
            currentIndex = (currentIndex + 1) % filteredWords.length;
            updateCard();
            setTimeout(() => { isNavigating = false; }, 250);
        }

        function prevCard() {
            if (isNavigating) return;
            isNavigating = true;
            currentIndex = (currentIndex - 1 + filteredWords.length) % filteredWords.length;
            updateCard();
            setTimeout(() => { isNavigating = false; }, 250);
        }

        function changeCategory() {
            currentCategory = document.getElementById('categorySelect').value;
            if (currentCategory === 'all') {
                filteredWords = [...words];
            } else {
                filteredWords = words.filter(w => w.category === currentCategory);
            }
            currentIndex = 0;
            updateCard();
        }

        function shuffleCards() {
            for (let i = filteredWords.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [filteredWords[i], filteredWords[j]] = [filteredWords[j], filteredWords[i]];
            }
            currentIndex = 0;
            updateCard();
        }

        function resetOrder() {
            if (currentCategory === 'all') {
                filteredWords = [...words];
            } else {
                filteredWords = words.filter(w => w.category === currentCategory);
            }
            currentIndex = 0;
            updateCard();
        }

        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
            isLongPress = false;
            longPressTimer = setTimeout(() => {
                isLongPress = true;
                revealTemporary();
            }, 300);
        });

        document.addEventListener('touchmove', e => {
            const moveX = Math.abs(e.changedTouches[0].screenX - touchStartX);
            const moveY = Math.abs(e.changedTouches[0].screenY - touchStartY);
            if (moveX > 10 || moveY > 10) {
                clearTimeout(longPressTimer);
            }
        });

        document.addEventListener('touchend', e => {
            clearTimeout(longPressTimer);
            if (isLongPress) {
                hideTemporary();
                isLongPress = false;
                return;
            }
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const diff = touchStartX - touchEndX;
            if (Math.abs(diff) > 80) {
                if (diff > 0) nextCard();
                else prevCard();
            }
        }

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowRight') nextCard();
            if (e.key === 'ArrowLeft') prevCard();
            if (e.key === ' ') { e.preventDefault(); revealTemporary(); }
        });

        document.addEventListener('keyup', e => {
            if (e.key === ' ') hideTemporary();
        });

        document.addEventListener('DOMContentLoaded', function() {
            loadState();
            updateCard();
        });
    </script>
</body>
</html>
