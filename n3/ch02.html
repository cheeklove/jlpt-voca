<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>N3 ë‹¨ì–´ì¥ Ch.2</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #1a1a2e; color: #eee; min-height: 100vh; user-select: none; -webkit-user-select: none; }
        .container { max-width: 500px; margin: 0 auto; padding: 12px; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 8px; }
        h1 { font-size: 1.3rem; margin: 0; color: #fff; }
        .progress { font-size: 0.9rem; color: #888; }
        .controls { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 12px; justify-content: center; }
        .toggle-btn { padding: 8px 14px; border: none; border-radius: 20px; font-size: 0.85rem; cursor: pointer; transition: all 0.2s; }
        .toggle-btn.active { background: #4a5568; color: #fff; }
        .toggle-btn.inactive { background: #2d3748; color: #718096; }
        .toggle-btn.shuffle { background: #805ad5; color: #fff; }
        .toggle-btn.reset { background: #dd6b20; color: #fff; }
        .category-select { width: 100%; padding: 10px; border: none; border-radius: 10px; background: #2d3748; color: #fff; font-size: 0.95rem; margin-bottom: 12px; }
        .card { background: linear-gradient(145deg, #16213e, #1a1a2e); border-radius: 16px; padding: 28px 20px; min-height: 280px; display: flex; flex-direction: column; justify-content: center; align-items: center; box-shadow: 0 8px 32px rgba(0,0,0,0.3); margin-bottom: 16px; border: 1px solid #2d3748; }
        .kanji { font-family: 'Noto Sans JP', sans-serif; font-size: 3rem; font-weight: bold; color: #fff; margin-bottom: 16px; text-align: center; line-height: 1.3; }
        .reading { font-family: 'Noto Sans JP', sans-serif; font-size: 1.4rem; color: #63b3ed; margin-bottom: 20px; text-align: center; }
        .meaning { font-size: 1.5rem; color: #68d391; text-align: center; padding: 12px 20px; background: rgba(104, 211, 145, 0.1); border-radius: 10px; }
        .hidden { visibility: hidden; }
        .nav-buttons { display: flex; gap: 12px; justify-content: center; }
        .nav-btn { flex: 1; max-width: 150px; padding: 14px 20px; border: none; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .nav-btn.prev { background: #4a5568; color: #fff; }
        .nav-btn.next { background: #4299e1; color: #fff; }
        .nav-btn:active { transform: scale(0.96); }
        .category-tag { font-size: 0.75rem; padding: 4px 10px; background: #4a5568; border-radius: 12px; margin-bottom: 16px; color: #a0aec0; }
        .tap-hint { text-align: center; font-size: 0.8rem; color: #555; margin-top: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../index.html#modal-n3" style="padding:6px 12px;background:#38a169;color:#fff;text-decoration:none;border-radius:8px;font-size:0.85rem;">â† í™ˆ</a>
            <h1>N3 ë‹¨ì–´ì¥ Ch.2</h1>
            <span class="progress" id="progress">1 / 100</span>
        </header>
        <select class="category-select" id="categorySelect" onchange="changeCategory()">
            <option value="all">ì „ì²´</option>
            <option value="ìŒë…ëª…ì‚¬">ìŒë… ëª…ì‚¬</option>
            <option value="í›ˆë…ëª…ì‚¬">í›ˆë… ëª…ì‚¬</option>
            <option value="ë™ì‚¬">ë™ì‚¬</option>
            <option value="ã„í˜•ìš©ì‚¬">ã„í˜•ìš©ì‚¬</option>
            <option value="ãªí˜•ìš©ì‚¬">ãªí˜•ìš©ì‚¬</option>
            <option value="ë¶€ì‚¬">ë¶€ì‚¬ ë° ê¸°íƒ€</option>
            <option value="ê°€íƒ€ì¹´ë‚˜">ê°€íƒ€ì¹´ë‚˜ì–´</option>
        </select>
        <div class="card" id="card">
            <span class="category-tag" id="categoryTag">ëª…ì‚¬</span>
            <div class="kanji" id="kanji">æ¼¢å­—</div>
            <div class="reading" id="reading">ã‹ã‚“ã˜</div>
            <div class="meaning" id="meaning">í•œì</div>
        </div>
        <div class="controls">
            <button class="toggle-btn reset" onclick="resetOrder()">â†º ì´ˆê¸°í™”</button>
            <button class="toggle-btn shuffle" onclick="shuffleCards()">ğŸ”€ ì…”í”Œ</button>
            <button class="toggle-btn active" id="toggleReading" onclick="toggleReading()">ë°œìŒ í‘œì‹œ</button>
            <button class="toggle-btn active" id="toggleMeaning" onclick="toggleMeaning()">ì •ë‹µ í‘œì‹œ</button>
        </div>
        <div class="nav-buttons">
            <button class="nav-btn prev" onclick="prevCard()">â—€ ì´ì „</button>
            <button class="nav-btn next" onclick="nextCard()">ë‹¤ìŒ â–¶</button>
        </div>
        <p class="tap-hint">ì¹´ë“œë¥¼ ê¸¸ê²Œ ëˆ„ë¥´ë©´ ì •ë‹µ í‘œì‹œ</p>
    </div>
    <script>
        const STORAGE_KEY = 'n3_ch02_state';
        const words = [
            // ìŒë… ëª…ì‚¬
            {kanji: "ãŠæœ­", reading: "ãŠã•ã¤", meaning: "ì§€í", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ãŠèŒ¶", reading: "ãŠã¡ã‚ƒ", meaning: "ì°¨", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ãŠé¢¨å‘‚", reading: "ãŠãµã‚", meaning: "ìš•ì¡°, ìš•ì‹¤, ëª©ìš•", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ãŠç¤¼", reading: "ãŠã‚Œã„", meaning: "ê°ì‚¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "éŸ³æ¥½", reading: "ãŠã‚“ãŒã", meaning: "ìŒì•…", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ¸©æ³‰", reading: "ãŠã‚“ã›ã‚“", meaning: "ì˜¨ì²œ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¼šé¤¨", reading: "ã‹ã„ã‹ã‚“", meaning: "íšŒê´€", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æµ·å²¸", reading: "ã‹ã„ãŒã‚“", meaning: "í•´ì•ˆ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¼šè­°", reading: "ã‹ã„ã", meaning: "íšŒì˜", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è§£æ±º", reading: "ã‹ã„ã‘ã¤", meaning: "í•´ê²°", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å¤–å›½", reading: "ãŒã„ã“ã", meaning: "ì™¸êµ­", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¼šç¤¾", reading: "ã‹ã„ã—ã‚ƒ", meaning: "íšŒì‚¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¼šå ´", reading: "ã‹ã„ã˜ã‚‡ã†", meaning: "ëª¨ì„ ì¥ì†Œ, íšŒì¥", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¼šè©±", reading: "ã‹ã„ã‚", meaning: "íšŒí™”", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¾¡æ ¼", reading: "ã‹ã‹ã", meaning: "ê°€ê²©", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ç§‘å­¦", reading: "ã‹ãŒã", meaning: "ê³¼í•™", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ç¢ºèª", reading: "ã‹ãã«ã‚“", meaning: "í™•ì¸", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "éå»", reading: "ã‹ã“", meaning: "ê³¼ê±°", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ç«äº‹", reading: "ã‹ã˜", meaning: "í™”ì¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ­Œæ‰‹", reading: "ã‹ã—ã‚…", meaning: "ê°€ìˆ˜", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "ä¸‹ç·š", reading: "ã‹ã›ã‚“", meaning: "ë°‘ì¤„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å®¶æ—", reading: "ã‹ãã", meaning: "ê°€ì¡±", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "èª²é•·", reading: "ã‹ã¡ã‚‡ã†", meaning: "ê³¼ì¥", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ¥½å™¨", reading: "ãŒã£ã", meaning: "ì•…ê¸°", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å­¦ç´š", reading: "ãŒã£ãã‚…ã†", meaning: "í•™ê¸‰", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ´»å‹•", reading: "ã‹ã¤ã©ã†", meaning: "í™œë™", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å®¶åº­", reading: "ã‹ã¦ã„", meaning: "ê°€ì •", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æˆ‘æ…¢", reading: "ãŒã¾ã‚“", meaning: "ì°¸ìŒ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ„Ÿè¦š", reading: "ã‹ã‚“ã‹ã", meaning: "ê°ê°", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è¦³å®¢", reading: "ã‹ã‚“ãã‚ƒã", meaning: "ê´€ê°", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "é–¢ä¿‚", reading: "ã‹ã‚“ã‘ã„", meaning: "ê´€ê³„", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è¦³å…‰", reading: "ã‹ã‚“ã“ã†", meaning: "ê´€ê´‘", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "çœ‹è­·å£«", reading: "ã‹ã‚“ã”ã—", meaning: "ê°„í˜¸ì‚¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "è¦³å¯Ÿ", reading: "ã‹ã‚“ã•ã¤", meaning: "ê´€ì°°", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ„Ÿã˜", reading: "ã‹ã‚“ã˜", meaning: "ëŠë‚Œ", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ¼¢å­—", reading: "ã‹ã‚“ã˜", meaning: "í•œì", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "é–¢å¿ƒ", reading: "ã‹ã‚“ã—ã‚“", meaning: "ê´€ì‹¬", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å®Œæˆ", reading: "ã‹ã‚“ã›ã„", meaning: "ì™„ì„±", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "æ„Ÿå‹•", reading: "ã‹ã‚“ã©ã†", meaning: "ê°ë™", category: "ìŒë…ëª…ì‚¬"},
            {kanji: "å®Œäº†", reading: "ã‹ã‚“ã‚Šã‚‡ã†", meaning: "ì™„ë£Œ", category: "ìŒë…ëª…ì‚¬"},
            
            // í›ˆë… ëª…ì‚¬
            {kanji: "ãŠé…’", reading: "ãŠã•ã‘", meaning: "ìˆ ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠçš¿", reading: "ãŠã•ã‚‰", meaning: "ì ‘ì‹œ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠã—ã¾ã„", reading: "ãŠã—ã¾ã„", meaning: "ë", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å¤«", reading: "ãŠã£ã¨", meaning: "ë‚¨í¸", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠã¤ã‚Š", reading: "ãŠã¤ã‚Š", meaning: "ê±°ìŠ¤ë¦„ëˆ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "éŸ³", reading: "ãŠã¨", meaning: "ì†Œë¦¬", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å¼Ÿ", reading: "ãŠã¨ã†ã¨", meaning: "ë‚¨ë™ìƒ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ç”·", reading: "ãŠã¨ã“", meaning: "ë‚¨ì", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠã¨ã¨ã„", reading: "ãŠã¨ã¨ã„", meaning: "ê·¸ì €ê»˜", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠã¨ã¨ã—", reading: "ãŠã¨ã¨ã—", meaning: "ì¬ì‘ë…„", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å¤§äºº", reading: "ãŠã¨ãª", meaning: "ì–´ë¥¸", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠè…¹", reading: "ãŠãªã‹", meaning: "ë°°, ë³µë¶€", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠå§‰ã•ã‚“", reading: "ãŠã­ãˆã•ã‚“", meaning: "ëˆ„ë‚˜, ì–¸ë‹ˆ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠè¦‹èˆã„", reading: "ãŠã¿ã¾ã„", meaning: "ë³‘ë¬¸ì•ˆ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠåœŸç”£", reading: "ãŠã¿ã‚„ã’", meaning: "(ì—¬í–‰) ì„ ë¬¼, ê¸°ë…í’ˆ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠã‚‚ã¡ã‚ƒ", reading: "ãŠã‚‚ã¡ã‚ƒ", meaning: "ì¥ë‚œê°", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "è¡¨", reading: "ãŠã‚‚ã¦", meaning: "ê²‰", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "è¦ª", reading: "ãŠã‚„", meaning: "ë¶€ëª¨", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ãŠæ¹¯", reading: "ãŠã‚†", meaning: "ë”ìš´ë¬¼, ë“ì¸ ë¬¼", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "çµ‚ã‚ã‚Š", reading: "ãŠã‚ã‚Š", meaning: "ë", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "è²·ã„ç‰©", reading: "ã‹ã„ã‚‚ã®", meaning: "ì‡¼í•‘", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é¡”", reading: "ã‹ãŠ", meaning: "ì–¼êµ´", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é¦™ã‚Š", reading: "ã‹ãŠã‚Š", meaning: "í–¥ê¸°", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é¡", reading: "ã‹ãŒã¿", meaning: "ê±°ìš¸", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "éµ", reading: "ã‹ã", meaning: "ì—´ì‡ ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å‚˜", reading: "ã‹ã•", meaning: "ìš°ì‚°", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "æ•°", reading: "ã‹ãš", meaning: "ìˆ˜", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é¢¨", reading: "ã‹ãœ", meaning: "ë°”ëŒ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é¢¨é‚ª", reading: "ã‹ãœ", meaning: "ê°ê¸°", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å½¢", reading: "ã‹ãŸã¡", meaning: "ëª¨ì–‘", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å½¼å¥³", reading: "ã‹ã®ã˜ã‚‡", meaning: "ê·¸ë…€, ì—¬ìì¹œêµ¬", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å£", reading: "ã‹ã¹", meaning: "ë²½", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ç´™", reading: "ã‹ã¿", meaning: "ì¢…ì´", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ç¥", reading: "ã‹ã¿", meaning: "ì‹ ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é«ª", reading: "ã‹ã¿", meaning: "ë¨¸ë¦¬í„¸, ë¨¸ë¦¬ì¹´ë½", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "é«ªã®æ¯›", reading: "ã‹ã¿ã®ã‘", meaning: "ë¨¸ë¦¬ì¹´ë½", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ç©º", reading: "ã‹ã‚‰", meaning: "í—ˆê³µ, ë¹”", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ä½“", reading: "ã‹ã‚‰ã ", meaning: "ëª¸", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "å½¼", reading: "ã‹ã‚Œ", meaning: "ê·¸, ë‚¨ì", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "ä»£ã‚ã‚Š", reading: "ã‹ã‚ã‚Š", meaning: "ëŒ€ì‹ ", category: "í›ˆë…ëª…ì‚¬"},
            {kanji: "è€ƒãˆæ–¹", reading: "ã‹ã‚“ãŒãˆã‹ãŸ", meaning: "ì‚¬ê³ ë°©ì‹", category: "í›ˆë…ëª…ì‚¬"},
            
            // ë™ì‚¬
            {kanji: "ç”³ã—è¾¼ã‚€", reading: "ã‚‚ã†ã—ã“ã‚€", meaning: "ì‹ ì²­í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å—ã‘ä»˜ã‘", reading: "ã†ã‘ã¤ã‘", meaning: "ì ‘ìˆ˜", category: "ë™ì‚¬"},
            {kanji: "æ¤ãˆã‚‹", reading: "ã†ãˆã‚‹", meaning: "ì‹¬ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å—ã‘ä»˜ã‘ã‚‹", reading: "ã†ã‘ã¤ã‘ã‚‹", meaning: "ì ‘ìˆ˜í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å—ã‘ã‚‹", reading: "ã†ã‘ã‚‹", meaning: "ë°›ë‹¤, ì¹˜ë¥´ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å‹•ã‹ã™", reading: "ã†ã”ã‹ã™", meaning: "ì›€ì§ì´ê²Œ í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å‹•ã", reading: "ã†ã”ã", meaning: "ì›€ì§ì´ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ­Œã†", reading: "ã†ãŸã†", meaning: "ë…¸ë˜í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç–‘ã†", reading: "ã†ãŸãŒã†", meaning: "ì˜ì‹¬í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ‰“ã¤", reading: "ã†ã¤", meaning: "ì¹˜ë‹¤, ë•Œë¦¬ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å†™ã™", reading: "ã†ã¤ã™", meaning: "ì°ë‹¤, ë² ë¼ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ˜ ã‚‹", reading: "ã†ã¤ã‚‹", meaning: "(ë°˜ì‚¬ë˜ì–´) ë¹„ì¶”ë‹¤, ìƒì˜í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç§»ã™", reading: "ã†ã¤ã™", meaning: "(ìë¦¬ë¥¼) ì˜®ê¸°ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç”Ÿã‚€", reading: "ã†ã‚€", meaning: "ë‚³ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç”Ÿã¾ã‚Œã‚‹", reading: "ã†ã¾ã‚Œã‚‹", meaning: "íƒœì–´ë‚˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å£²ã‚‹", reading: "ã†ã‚‹", meaning: "íŒ”ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å£²ã‚Œã‚‹", reading: "ã†ã‚Œã‚‹", meaning: "íŒ”ë¦¬ë‹¤", category: "ë™ì‚¬"},
            {kanji: "é¸ã¶", reading: "ãˆã‚‰ã¶", meaning: "ê³ ë¥´ë‹¤, ì„ íƒí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å¾—ã‚‹", reading: "ãˆã‚‹", meaning: "ì–»ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è¿½ã„ä»˜ã", reading: "ãŠã„ã¤ã", meaning: "ë”°ë¼ë¶™ë‹¤, ë”°ë¼ì¡ë‹¤", category: "ë™ì‚¬"},
            {kanji: "çµ‚ãˆã‚‹", reading: "ãŠãˆã‚‹", meaning: "ëë‚´ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è¿½ã†", reading: "ãŠã†", meaning: "ì«“ë‹¤", category: "ë™ì‚¬"},
            {kanji: "èµ·ãã‚‹", reading: "ãŠãã‚‹", meaning: "(ìë¦¬ì—ì„œ) ì¼ì–´ë‚˜ë‹¤, ë°œìƒí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ç½®ã", reading: "ãŠã", meaning: "ë†“ë‹¤, ë‘ë‹¤", category: "ë™ì‚¬"},
            {kanji: "é€ã‚‹", reading: "ãŠãã‚‹", meaning: "ë³´ë‚´ë‹¤, ë°”ë˜ë‹¤ ì£¼ë‹¤, ë°œì†¡í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è´ˆã‚‹", reading: "ãŠãã‚‹", meaning: "(ì„ ë¬¼ì„) ë³´ë‚´ë‹¤, ì„ ë¬¼í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "å±Šã", reading: "ã¨ã©ã", meaning: "ë‹¿ë‹¤", category: "ë™ì‚¬"},
            {kanji: "é…ã‚Œã‚‹", reading: "ãŠãã‚Œã‚‹", meaning: "ëŠ¦ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è¡Œã†", reading: "ãŠã“ãªã†", meaning: "í–‰í•˜ë‹¤, ì‹¤í–‰í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ€’ã‚‹", reading: "ãŠã“ã‚‹", meaning: "í™”ë‚´ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ãŠã”ã‚‹", reading: "ãŠã”ã‚‹", meaning: "í•œí„±ë‚´ë‹¤", category: "ë™ì‚¬"},
            {kanji: "æ•™ãˆã‚‹", reading: "ãŠã—ãˆã‚‹", meaning: "ê°€ë¥´ì¹˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è½ã¡ç€ã", reading: "ãŠã¡ã¤ã", meaning: "ì¹¨ì°©í•˜ë‹¤, ì§„ì •í•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è½ã¡ã‚‹", reading: "ãŠã¡ã‚‹", meaning: "ë–¨ì–´ì§€ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è½ã¨ã™", reading: "ãŠã¨ã™", meaning: "ë–¨ì–´ëœ¨ë¦¬ë‹¤, ìƒì–´ë²„ë¦¬ë‹¤", category: "ë™ì‚¬"},
            {kanji: "é©šã", reading: "ãŠã©ã‚ã", meaning: "ë†€ë¼ë‹¤", category: "ë™ì‚¬"},
            {kanji: "è¦šãˆã‚‹", reading: "ãŠã¼ãˆã‚‹", meaning: "ê¸°ì–µí•˜ë‹¤", category: "ë™ì‚¬"},
            {kanji: "ãŠã¼ã‚Œã‚‹", reading: "ãŠã¼ã‚Œã‚‹", meaning: "(ë¬¼ì—) ë¹ ì§€ë‹¤, ì •ì‹ ì´ íŒ”ë¦¬ë‹¤", category: "ë™ì‚¬"},
            
            // ã„í˜•ìš©ì‚¬
            {kanji: "å±ãªã„", reading: "ã‚ã¶ãªã„", meaning: "ìœ„í—˜í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ç”˜ã„", reading: "ã‚ã¾ã„", meaning: "ë‹¬ì½¤í•˜ë‹¤, ë§Œë§Œí•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ã‚ã‚„ã—ã„", reading: "ã‚ã‚„ã—ã„", meaning: "ìˆ˜ìƒì©ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "è’ã„", reading: "ã‚ã‚‰ã„", meaning: "ê±°ì¹ ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ã‚ã‚ãŸã ã—ã„", reading: "ã‚ã‚ãŸã ã—ã„", meaning: "ë¶„ì£¼í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "å¿™ã—ã„", reading: "ã„ããŒã—ã„", meaning: "ë°”ì˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ç—›ã„", reading: "ã„ãŸã„", meaning: "ì•„í”„ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "è–„ã„", reading: "ã†ã™ã„", meaning: "ì–‡ë‹¤, íë¦¬ë‹¤, ì—°í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ç¾ã—ã„", reading: "ã†ã¤ãã—ã„", meaning: "ì•„ë¦„ë‹µë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            {kanji: "ã†ã¾ã„", reading: "ã†ã¾ã„", meaning: "ë§›ìˆë‹¤, ì˜í•˜ë‹¤", category: "ã„í˜•ìš©ì‚¬"},
            
            // ãªí˜•ìš©ì‚¬
            {kanji: "ãŠãŠã–ã£ã±ã ", reading: "ãŠãŠã–ã£ã±ã ", meaning: "ëŒ€ëµì ì´ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "åŒã˜ã ", reading: "ãŠãªã˜ã ", meaning: "ê°™ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "ä¸»ã ", reading: "ãŠã‚‚ã ", meaning: "ì£¼ë˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "ç¢ºå®Ÿã ", reading: "ã‹ãã˜ã¤ã ", meaning: "í™•ì‹¤í•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "å‹æ‰‹ã ", reading: "ã‹ã£ã¦ã ", meaning: "ì œë©‹ëŒ€ë¡œë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "ã‹ã‚ã„ãã†ã ", reading: "ã‹ã‚ã„ãã†ã ", meaning: "ë¶ˆìŒí•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "å®Œå…¨ã ", reading: "ã‹ã‚“ãœã‚“ã ", meaning: "ì™„ì „í•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            {kanji: "ç°¡å˜ã ", reading: "ã‹ã‚“ãŸã‚“ã ", meaning: "ê°„ë‹¨í•˜ë‹¤", category: "ãªí˜•ìš©ì‚¬"},
            
            // ë¶€ì‚¬ ë° ê¸°íƒ€
            {kanji: "ã†ã£ã‹ã‚Š", reading: "ã†ã£ã‹ã‚Š", meaning: "ë¬´ì‹¬ì½”", category: "ë¶€ì‚¬"},
            {kanji: "ã†ã‚“ã¨", reading: "ã†ã‚“ã¨", meaning: "í›¨ì”¬", category: "ë¶€ì‚¬"},
            {kanji: "ãŠã‚ˆã", reading: "ãŠã‚ˆã", meaning: "ëŒ€ê°•", category: "ë¶€ì‚¬"},
            {kanji: "ãŒã£ã‹ã‚Š", reading: "ãŒã£ã‹ã‚Š", meaning: "ì‹¤ë§í•˜ëŠ” ëª¨ì–‘", category: "ë¶€ì‚¬"},
            {kanji: "å¿…ãš", reading: "ã‹ãªã‚‰ãš", meaning: "ë°˜ë“œì‹œ", category: "ë¶€ì‚¬"},
            {kanji: "å¿…ãšã—ã‚‚", reading: "ã‹ãªã‚‰ãšã—ã‚‚", meaning: "ë°˜ë“œì‹œ (~ì¸ ê²ƒì€ ì•„ë‹ˆë‹¤)", category: "ë¶€ì‚¬"},
            {kanji: "ã‹ãªã‚Š", reading: "ã‹ãªã‚Š", meaning: "ê½¤, ìƒë‹¹íˆ", category: "ë¶€ì‚¬"},
            {kanji: "ãŒã‚‰ãŒã‚‰", reading: "ãŒã‚‰ãŒã‚‰", meaning: "í……ë¹ˆ ëª¨ì–‘", category: "ë¶€ì‚¬"},
            {kanji: "çµå±€", reading: "ã‘ã£ãã‚‡ã", meaning: "ê²°êµ­", category: "ë¶€ì‚¬"},
            
            // ê°€íƒ€ì¹´ë‚˜ì–´
            {kanji: "ã‚¤ãƒ¡ãƒ¼ã‚¸", reading: "ã‚¤ãƒ¡ãƒ¼ã‚¸", meaning: "ì´ë¯¸ì§€", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", reading: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", meaning: "ì—ë„ˆì§€", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚ªãƒ¼ãƒˆãƒã‚¤", reading: "ã‚ªãƒ¼ãƒˆãƒã‚¤", meaning: "ì˜¤í† ë°”ì´", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚ªãƒ¼ãƒãƒ¼", reading: "ã‚ªãƒ¼ãƒãƒ¼", meaning: "ì˜¤ë²„, ì½”íŠ¸", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚«ã‚¿ãƒ­ã‚°", reading: "ã‚«ã‚¿ãƒ­ã‚°", meaning: "ì¹´íƒˆë¡œê·¸", category: "ê°€íƒ€ì¹´ë‚˜"},
            {kanji: "ã‚«ãƒ¼ãƒ†ãƒ³", reading: "ã‚«ãƒ¼ãƒ†ãƒ³", meaning: "ì»¤íŠ¼", category: "ê°€íƒ€ì¹´ë‚˜"},
        ];

        let currentIndex = 0;
        let filteredWords = [...words];
        let showReading = true;
        let showMeaning = true;
        let currentCategory = 'all';
        let isNavigating = false;
        let longPressTimer = null;
        let isLongPress = false;

        function saveState() {
            const state = { currentIndex, showReading, showMeaning, currentCategory };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const state = JSON.parse(saved);
                currentIndex = state.currentIndex || 0;
                showReading = state.showReading !== undefined ? state.showReading : true;
                showMeaning = state.showMeaning !== undefined ? state.showMeaning : true;
                currentCategory = state.currentCategory || 'all';
                document.getElementById('categorySelect').value = currentCategory;
                if (currentCategory !== 'all') {
                    filteredWords = words.filter(w => w.category === currentCategory);
                }
                if (currentIndex >= filteredWords.length) currentIndex = 0;
                updateToggleButtons();
            }
        }

        function updateToggleButtons() {
            const readingBtn = document.getElementById('toggleReading');
            const meaningBtn = document.getElementById('toggleMeaning');
            readingBtn.className = showReading ? 'toggle-btn active' : 'toggle-btn inactive';
            readingBtn.textContent = showReading ? 'ë°œìŒ í‘œì‹œ' : 'ë°œìŒ ìˆ¨ê¹€';
            meaningBtn.className = showMeaning ? 'toggle-btn active' : 'toggle-btn inactive';
            meaningBtn.textContent = showMeaning ? 'ì •ë‹µ í‘œì‹œ' : 'ì •ë‹µ ìˆ¨ê¹€';
        }

        function updateCard() {
            const word = filteredWords[currentIndex];
            document.getElementById('kanji').textContent = word.kanji;
            document.getElementById('reading').textContent = word.reading;
            document.getElementById('meaning').textContent = word.meaning;
            document.getElementById('categoryTag').textContent = word.category;
            document.getElementById('progress').textContent = `${currentIndex + 1} / ${filteredWords.length}`;
            applyVisibility();
            saveState();
        }

        function applyVisibility() {
            document.getElementById('reading').className = showReading ? 'reading' : 'reading hidden';
            document.getElementById('meaning').className = showMeaning ? 'meaning' : 'meaning hidden';
        }

        function toggleReading() {
            showReading = !showReading;
            updateToggleButtons();
            applyVisibility();
            saveState();
        }

        function toggleMeaning() {
            showMeaning = !showMeaning;
            updateToggleButtons();
            applyVisibility();
            saveState();
        }

        function revealTemporary() {
            document.getElementById('reading').className = 'reading';
            document.getElementById('meaning').className = 'meaning';
        }

        function hideTemporary() {
            applyVisibility();
        }

        function nextCard() {
            if (isNavigating) return;
            isNavigating = true;
            currentIndex = (currentIndex + 1) % filteredWords.length;
            updateCard();
            setTimeout(() => { isNavigating = false; }, 250);
        }

        function prevCard() {
            if (isNavigating) return;
            isNavigating = true;
            currentIndex = (currentIndex - 1 + filteredWords.length) % filteredWords.length;
            updateCard();
            setTimeout(() => { isNavigating = false; }, 250);
        }

        function changeCategory() {
            currentCategory = document.getElementById('categorySelect').value;
            if (currentCategory === 'all') {
                filteredWords = [...words];
            } else {
                filteredWords = words.filter(w => w.category === currentCategory);
            }
            currentIndex = 0;
            updateCard();
        }

        function shuffleCards() {
            for (let i = filteredWords.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [filteredWords[i], filteredWords[j]] = [filteredWords[j], filteredWords[i]];
            }
            currentIndex = 0;
            updateCard();
        }

        function resetOrder() {
            if (currentCategory === 'all') {
                filteredWords = [...words];
            } else {
                filteredWords = words.filter(w => w.category === currentCategory);
            }
            currentIndex = 0;
            updateCard();
        }

        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
            isLongPress = false;
            longPressTimer = setTimeout(() => {
                isLongPress = true;
                revealTemporary();
            }, 300);
        });

        document.addEventListener('touchmove', e => {
            const moveX = Math.abs(e.changedTouches[0].screenX - touchStartX);
            const moveY = Math.abs(e.changedTouches[0].screenY - touchStartY);
            if (moveX > 10 || moveY > 10) {
                clearTimeout(longPressTimer);
            }
        });

        document.addEventListener('touchend', e => {
            clearTimeout(longPressTimer);
            if (isLongPress) {
                hideTemporary();
                isLongPress = false;
                return;
            }
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const diff = touchStartX - touchEndX;
            if (Math.abs(diff) > 80) {
                if (diff > 0) nextCard();
                else prevCard();
            }
        }

        document.addEventListener('keydown', e => {
            if (e.key === 'ArrowRight') nextCard();
            if (e.key === 'ArrowLeft') prevCard();
            if (e.key === ' ') { e.preventDefault(); revealTemporary(); }
        });

        document.addEventListener('keyup', e => {
            if (e.key === ' ') hideTemporary();
        });

        document.addEventListener('DOMContentLoaded', function() {
            loadState();
            updateCard();
        });
    </script>
</body>
</html>
